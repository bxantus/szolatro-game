"use strict";(()=>{var u=class{constructor(e){this.compute=e}};function o(n){return new u(n)}var m=class{constructor(e,t){this.bindings=[];this.objRef=new WeakRef(e),t&&this.bindings.push(t)}refresh(){let e=this.objRef.deref();if(e)for(let t of this.bindings)R(e,t)}};function R(n,e){let t=e.calc.compute();typeof e.prop=="object"?e.prop.get()!=t&&e.prop.set(t):n[e.prop]!=t&&(n[e.prop]=t)}var L=class n{constructor(e){this.isVisible=!0;this.isConnected=!1;this.children=[];e&&(this.bindings=new m(e))}get visible(){return this.isVisible}updateVisible(){let e=this.isVisible;if(this.visibleBinding?this.isVisible=this.visibleBinding.calc.compute():this.isVisible=!0,e!=this.isVisible){if(this.isVisible)this.connected();else for(let t of n.nodesOfTree(this))t.isVisible=!1,t.disconnected();if(this.visibleBinding){let t=this.bindings?.objRef.deref();if(!t)return;this.isVisible?B(t):x(t)}}}addListener(e){this.isConnected&&e.onConnected(),this.listeners?this.listeners.push(e):this.listeners=[e]}addChild(e){return this.children.push(e),this.isVisible?e.isVisible&&e.connected():e.isVisible=!1,e}removeChild(e){let t=this.children.indexOf(e);this.children.splice(t,1),e.removeSubTree()}removeSubTree(){this.disconnected();for(let e of this.children)e.removeSubTree();this.children.splice(0,1/0)}static*nodesOfTree(e){yield e;for(let t of e.children)yield*n.nodesOfTree(t)}connected(){if(!this.isConnected&&(this.isConnected=!0,!!this.listeners))for(let e of this.listeners)e.onConnected()}disconnected(){if(this.isConnected&&(this.isConnected=!1,!!this.listeners))for(let e of this.listeners)e.onDisconnected()}},w=class{constructor(){this.nodesByElement=new WeakMap;this.root=new L}getForElement(e){return this.nodesByElement.get(e)}getOrCreateForElement(e){let t=this.nodesByElement.get(e);return t||(t=new L(e),this.nodesByElement.set(e,t),t)}},f=new w,M=n=>f.getOrCreateForElement(n);function k(n){if(n.updateVisible(),!n.visible)return 0;let e=0;n.bindings&&(n.bindings.refresh(),e++);for(let t of n.children)e+=k(t);return e}function P(n){requestAnimationFrame(P),F(n);let e=v.length;for(let t=0;t<e;++t)v[t]();v.splice(0,e),p.running=!0;for(let t of h)t.enabled&&t.update();p.running=!1,p.dirty&&(h=h.filter(t=>t.enabled),p.dirty=!1),b.numLightBoundObjects=k(f.root)}var v=[],p={running:!1,dirty:!1},h=[];function V(n){for(;n;n=n.parentElement){let e=f.getForElement(n);if(e)return e}return f.root}var O=(n,e)=>{let t=f.getForElement(n);t&&(e=e.addChild(t));for(let i=0;i<n.children.length;++i){let r=n.children[i];r instanceof HTMLElement&&O(r,e)}},S=(n,e)=>{let t=f.getForElement(n);if(t)e.removeChild(t);else for(let i=0;i<n.children.length;++i){let r=n.children[i];r instanceof HTMLElement&&S(r,e)}},W=(n,e)=>{for(let i of n)i.addedNodes.forEach(r=>{r.nodeType==1&&r instanceof HTMLElement&&O(r,V(i.target))}),i.removedNodes.forEach(r=>{r.nodeType==1&&r instanceof HTMLElement&&S(r,V(i.target))})},X=new MutationObserver(W),N;function D(){N==null&&(N=requestAnimationFrame(P),window.addEventListener("load",n=>{X.observe(document.body,{subtree:!0,childList:!0})}))}var b={timestamp:0,numLightBoundObjects:0,numRecurringUpdates:h.length,fps:60},g,y=0,U=200;function F(n){if(b.timestamp=n,b.numRecurringUpdates=h.length,g===void 0)g=n;else{let e=n-g;y++,e>=U&&(b.fps=Math.round(y*1e3/e),y=0,g=n)}}function a(n,e,...t){let i=document.createElement(n),r=i;if(e?.id&&(r.id=e.id),e?.class&&I(r,"className",e.class),e?.text&&I(r,"textContent",e.text),e?.onClick&&(r.onclick=l=>e.onClick.call(i,l)),e?.visible!=null)if(e.visible instanceof u){let l=M(r);l.visibleBinding={prop:"visible",calc:e.visible},l.updateVisible()}else e.visible||x();if(t)for(let l of t)l&&(typeof l=="string"||l instanceof HTMLElement?r.append(l):r.append(l.element));return i}function d(n,...e){return a("div",n,...e)}function c(n,...e){return a("span",n,...e)}function I(n,e,t){t instanceof u?(n[e]=t.compute(),M(n).bindings.bindings.push({prop:e,calc:t})):n[e]=t}function x(...n){for(let e of n)e.style.display="none"}function B(...n){for(let e of n)e.style.display=""}D();var s=class{constructor(e,t){this.letter=e;this.score=t}},T=class n{constructor(){this.letters=[]}add(e,t=1){this.letters.push(e);for(let i=1;i<t;++i)this.letters.push(new s(e.letter,e.score))}pickLetters(e){let t=[];for(let i=0;i<e&&this.letters.length>0;++i){let r=Math.floor(Math.random()*this.letters.length);t.push(this.letters[r]),this.letters.splice(r,1)}return t}static makeHungarianLetterBag(){let e=new n;return e.add(new s("A",1),6),e.add(new s("E",1),6),e.add(new s("K",1),6),e.add(new s("T",1),5),e.add(new s("\xC1",1),4),e.add(new s("L",1),4),e.add(new s("N",1),4),e.add(new s("R",1),4),e.add(new s("I",1),3),e.add(new s("M",1),3),e.add(new s("O",1),3),e.add(new s("S",1),3),e.add(new s("B",2),3),e.add(new s("D",2),3),e.add(new s("G",2),3),e.add(new s("\xD3",2),3),e.add(new s("\xC9",3),3),e.add(new s("H",3),2),e.add(new s("SZ",3),2),e.add(new s("V",3),2),e.add(new s("F",4),2),e.add(new s("GY",4),2),e.add(new s("J",4),2),e.add(new s("\xD6",4),2),e.add(new s("P",4),2),e.add(new s("U",4),2),e.add(new s("\xDC",4),2),e.add(new s("Z",4),2),e.add(new s("C",5),1),e.add(new s("\xCD",5),1),e.add(new s("NY",5),1),e.add(new s("CS",7),1),e.add(new s("\u0150",7),1),e.add(new s("\xDA",7),1),e.add(new s("\u0170",7),1),e.add(new s("LY",8),1),e.add(new s("ZS",8),1),e.add(new s("TY",10),1),e}};var C=class{deleteLetter(){this.onRemove?.(),this.onRemove=void 0,this.letter=void 0}},E=class{constructor(e){this.available=e;this.parts=[];this.cursor=0;this.parts=Array.from({length:e},()=>new C)}typeLetter(e,t){let i=this.parts[this.cursor];i.letter=e,i.onRemove=t,this.cursor++}backspace(){if(this.cursor==0)return;this.parts[--this.cursor].deleteLetter()}clear(){for(let e of this.parts)e.deleteLetter();this.cursor=0}get valid(){if(this.cursor==0)return!1;let e=this.parts.findIndex(t=>t.letter==null);return e==-1||e>=this.cursor}get word(){let e="";for(let t=0;t<this.cursor;++t){let i=this.parts[t];if(!i.letter)return"";e+=i.letter.letter}return e}};var H=class{constructor(){this.letterBag=T.makeHungarianLetterBag();this.NUM_LETTERS=16;this.letters=[];this.usedLetters=[];this.typedWord=new E(10);this.score=0;this.goal=35;this.remainingMoves=8;this.letters=this.letterBag.pickLetters(this.NUM_LETTERS).map(e=>({letter:e,available:!0}))}addControls(e){let t=()=>this.typedWord.cursor>0?"":"disabled";e.splice(4,0,a("button",{class:"btn btn-lg btn-danger fill w-100 h-100",text:"DEL",onClick:()=>this.typedWord.backspace()})),e.splice(9,0,a("button",{class:o(()=>`btn btn-lg btn-secondary fill w-100 h-100 ${t()}`),text:"\u{1F5D1}\uFE0F",onClick:()=>this.dropLetters()})),e.splice(14,0,a("button",{class:"btn btn-lg btn-info fill w-100 h-100",text:"\u{1F500}",onClick:()=>this.shuffleLetters()})),e.splice(19,0,a("button",{class:"btn btn-lg btn-success fill w-100 h-100",text:"OK",onClick:()=>this.submitWord()}))}displayLetters(){let e=[];for(let t=0;t<this.NUM_LETTERS;++t)e.push(this.letter(t));return this.addControls(e),d({class:"letters"},...e)}displayTypedWord(){return a("div",{class:"typed-word"},...this.typedWord.parts.map(e=>d({class:"letter"},a("button",{class:"btn btn-light fill w-100 h-100",text:o(()=>e.letter?.letter??"")}),c({class:"letter-score p-1",text:o(()=>e.letter?.score.toString()??"")}))))}letter(e){let t=()=>this.letters[e].letter?.letter??" ",i=()=>this.letters[e].letter?.score.toString()??"",r=()=>this.letters[e].available?"":"disabled";return d({class:o(()=>`letter ${r()}`),onClick:()=>this.letterClicked(e)},a("button",{class:"btn btn-lg btn-primary fill w-100 h-100",text:o(t)}),c({class:"letter-score p-1",text:o(i)}))}letterClicked(e){let t=this.letters[e];!t.available||!t.letter||(t.available=!1,this.typedWord.typeLetter(t.letter,()=>{t.available=!0,this.displayLetters()}))}submitWord(){if(console.log("Submitting word: ",this.typedWord.word),words.includes(this.typedWord.word)){console.log("Correct word!");for(let t of this.letters)t.available||(this.usedLetters.push(t.letter),t.letter=this.letterBag.pickLetters(1)[0],t.available=!0);let e=this.typedWord.parts.reduce((t,i)=>t+(i.letter?.score??0),0);this.score+=e,this.typedWord.clear(),this.remainingMoves--}else console.warn("Nope")}shuffleLetters(){for(let e=this.letters.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[this.letters[e],this.letters[t]]=[this.letters[t],this.letters[e]]}}dropLetters(){if(this.typedWord.cursor!=0){for(let e of this.letters)e.available||(this.usedLetters.push(e.letter),e.letter=this.letterBag.pickLetters(1)[0],e.available=!0);this.typedWord.clear(),this.remainingMoves--}}};window.onload=()=>{K(),document.body.append(d({class:"main m-3"},d({class:"h2 text-center",text:o(()=>"Sz\xF3l\xE1tr\xF3")}),d({class:"mt-2 mb-2 d-flex justify-content-between"},c({class:"goal",text:o(()=>`C\xE9l: ${game.goal}`)}),c({text:o(()=>`${game.remainingMoves} sz\xF3 maradt`)})),game.displayTypedWord(),game.displayLetters(),d({class:"scoreboard mt-3 text-end"},c({class:"score fw-bold",text:o(()=>`Pontsz\xE1m: ${game.score}`)})),d({class:"results mt-3 text-center",visible:o(()=>game.remainingMoves<=0||game.score>=game.goal)},c({class:"h2",text:"Siker \u{1F973}!",visible:o(()=>game.score>=game.goal)}),c({class:"h2",text:"\u{1F612} Majd m\xE1skor",visible:o(()=>game.remainingMoves<=0&&game.score<game.goal)}))))};async function K(){globalThis.game=new H,console.log("Fetching words...");let n=await fetch("./words").then(t=>t.text()),e=n.split(`
`).map(t=>t.trim().toUpperCase());console.log("Words fetched: ",n.length," characters. Total words: ",e.length),globalThis.words=e}})();
